# שינויים אחרונים במערכת דיווח השעות

## תיקונים שבוצעו ✅

### 1. תיקון תצוגת המקצועות המשויכים אצל הרכז
**בעיה:** הרכז לא ראה את המקצועות שהוא שייך לכל מדריך.

**פתרון:**
- תיקון השדה מ-`assignedSubjects` ל-`subjects` ([index.html:1644](index.html#L1644))
- הוספת קידוד צבעים למקצועות:
  - 🔵 **כחול** - מקצועות בוקר
  - 🟡 **צהוב** - מקצועות אחר הצהריים

### 2. הוספת כפתור "ערוך" לכל מדריך
**תכונה חדשה:** כעת ניתן לערוך את המקצועות המשויכים למדריך ללא צורך להסיר ולשייך מחדש.

**איך זה עובד:**
1. לחץ על "✏️ ערוך" ליד המדריך
2. נפתח חלון עריכה עם כל המקצועות
3. בחר/בטל בחירה של מקצועות
4. לחץ "שמור שינויים"

**מיקום הקוד:** [index.html:1764-1916](index.html#L1764-L1916)

### 3. קידוד צבעים במקצועות בזמן השיוך
**שיפור:** כאשר רכז משייך מדריך חדש, המקצועות מחולקים לפי משמרות עם צבעים:

- **📅 משמרת בוקר (כחול):**
  - תכנית בוקר
  - מחוננים

- **🌅 משמרת אחר הצהריים (צהוב):**
  - כימיה
  - מחשבים
  - אסטרונומיה

**מיקום הקוד:** [index.html:1595-1667](index.html#L1595-L1667)

### 4. הגדרות דינמיות למקצועות
**שיפור:** המקצועות מוגדרים בצורה מרכזית ודינמית.

**מיקום ההגדרות:** [index.html:1289-1290](index.html#L1289-L1290)
```javascript
const MORNING_SUBJECTS = ['תכנית בוקר', 'מחוננים'];
const AFTERNOON_SUBJECTS = ['כימיה', 'מחשבים', 'אסטרונומיה'];
```

### 5. שיפורי UI בכרטיס המדריך
**שיפורים:**
- הכפתורים מסודרים בעמודה (אנכית) במקום בשורה
- הוספת `white-space: nowrap` למניעת שבירת טקסט בכפתורים
- שיפור המרווחים והריווח

**מיקום:** [index.html:1678-1706](index.html#L1678-L1706)

---

## שימוש במערכת

### עבור רכז:

#### שיוך מדריך חדש:
1. בחר מדריך מהרשימה הנפתחת
2. המקצועות יופיעו מחולקים לבוקר (כחול) ואחה"צ (צהוב)
3. בחר את המקצועות הרצויים
4. לחץ "שייך מדריך"

#### עריכת שיוך קיים:
1. לחץ "✏️ ערוך" ליד המדריך
2. שנה את בחירת המקצועות
3. לחץ "שמור שינויים"
4. **חשוב:** המדריך יצטרך לרענן את הדף כדי לראות את השינוי

#### הסרת מדריך:
1. לחץ "🗑️ הסר" ליד המדריך
2. אשר את ההסרה

### עבור מדריך:

#### צפייה בטבלת שעות:
- הטבלה תציג **רק** את המקצועות שהרכזים שייכו לך
- המקצועות מחולקים אוטומטית לבוקר ואחר הצהריים
- **חשוב:** השינויים אינם דינמיים - צריך לרענן את הדף (F5) כדי לראות עדכונים

---

## הערות חשובות ⚠️

### עדכונים אינם דינמיים
כרגע, כאשר רכז משנה את המקצועות של מדריך:
- הרכז רואה את השינויים מיד
- **המדריך צריך לרענן את הדף** כדי לראות את השינויים

**מדוע?**
- הנתונים נטענים מ-Firebase רק בעת התחברות/רענון
- אין מנגנון real-time updates כרגע

**פתרון זמני:**
המדריך צריך לרענן את הדף (F5) אחרי שהרכז משנה את השיוכים.

### סינכרון עם Firebase
- כל שינוי נשמר מיד ל-Firebase
- השינויים נשמרים תחת: `users/{coordinatorEmail}/assignedInstructors`
- הפורמט:
  ```json
  {
    "email": "instructor@example.com",
    "subjects": ["כימיה", "מחשבים"]
  }
  ```

---

## קבצים שנוצרו

1. **[firebase-users.json](firebase-users.json)** - מבנה הנתונים המעודכן ל-Firebase
2. **[FIREBASE-SETUP-INSTRUCTIONS.md](FIREBASE-SETUP-INSTRUCTIONS.md)** - הוראות העלאה ל-Firebase
3. **[RECENT-CHANGES.md](RECENT-CHANGES.md)** - המסמך הנוכחי

---

## Debug Mode

להפעלת מצב debug, פתח את Console (F12) והקלד:
```javascript
localStorage.setItem('debug', 'true');
location.reload();
```

זה יציג לוגים מפורטים על טעינת המקצועות של המדריכים.
